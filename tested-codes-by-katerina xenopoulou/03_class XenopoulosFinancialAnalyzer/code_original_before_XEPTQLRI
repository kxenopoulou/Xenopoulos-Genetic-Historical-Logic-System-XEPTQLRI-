class ImprovedBankingStateMachine:
    def __init__(self):
        self.states = {
            'Î±NSÎ·': self._alpha_state_handler,
            'Î¼NSÏƒ': self._mu_state_handler, 
            'Ï„NSÎ·': self._tau_state_handler,
            'Î´NSÎ³': self._delinquency_handler,  # ÎÎ­Î± ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·
            'Ï‰NSÏ': self._overdue_handler       # ÎÎ­Î± ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·
        }
        self.current_state = 'Î±NSÎ·'
        self.transaction_history = []
    
    def _alpha_state_handler(self, transaction):
        """Î’ÎµÎ»Ï„Î¹Ï‰Î¼Î­Î½Î· Î±ÏÏ‡Î¹ÎºÎ® ÎµÏ€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î± Î¼Îµ Î¹ÏƒÏ„Î¿ÏÎ¹ÎºÏŒ Î­Î»ÎµÎ³Ï‡Î¿"""
        if self._has_delinquency_history(transaction.account_id):
            self._update_state('Î´NSÎ³')
            return self._delinquency_handler(transaction)
        
        if self._has_irregular_payment_pattern(transaction.account_id):
            self._flag_for_review(transaction)
        
        return self._basic_validation(transaction)
    
    def _delinquency_handler(self, transaction):
        """ÎšÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· Î´Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ·Ï‚ ÎºÎ±Î¸Ï…ÏƒÏ„ÎµÏÎ®ÏƒÎµÏ‰Î½"""
        if self._detect_compound_interest_risk(transaction):
            self._trigger_compound_interest_alert(transaction)
        
        if self._exceeds_delay_fee_limit(transaction.account_id):
            self._initiate_fee_waiver_process(transaction)
        
        return self._process_delinquent_transaction(transaction)
    
    def _tau_state_handler(self, transaction):
        """ÎšÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· Î¿Î»Î¿ÎºÎ»Î®ÏÏ‰ÏƒÎ·Ï‚"""
        self.transaction_history.append(transaction)
        return True
2. Î‘Î½Î¯Ï‡Î½ÎµÏ…ÏƒÎ· Î‘Ï€Î¬Ï„Î·Ï‚ (fraud_detector_advanced.py)
python



View all
class AdvancedFraudDetector:
    def __init__(self):
        self.ml_model = self._load_ml_model()
        self.patterns = self._load_fraud_patterns()
        self.anomaly_detector = AnomalyDetector()
    
    def detect_fraud(self, transaction):
        """Î£Ï…Î½Î´Ï…Î±ÏƒÎ¼Î­Î½Î¿Ï‚ Î­Î»ÎµÎ³Ï‡Î¿Ï‚ Î±Ï€Î¬Ï„Î·Ï‚"""
        checks = [
            self._check_ml_patterns(transaction),
            self._check_behavioral_anomalies(transaction),
            self._check_time_patterns(transaction),
            self._check_geolocation(transaction),
            self._check_amount_anomalies(transaction)
        ]
        
        return any(checks)
    
    def _load_ml_model(self):
        """Î¦ÏŒÏÏ„Ï‰ÏƒÎ· trained ML model"""
        return load_model('models/fraud_detection_v3.h5')
3. Î•Î½Î¹ÏƒÏ‡Ï…Î¼Î­Î½Î¿Ï‚ ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ Î£Ï…Î¼Î¼ÏŒÏÏ†Ï‰ÏƒÎ·Ï‚ (compliance_checker_advanced.py)
python


class EnhancedComplianceChecker:
    def __init__(self):
        self.regulatory_rules = RegulatoryRulesDatabase()
        self.audit_logger = EnhancedAuditLogger()
    
    def check_interest_rate_compliance(self, transaction):
        """ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ ÎµÏ€Î¹Ï„Î¿ÎºÎ¯Ï‰Î½"""
        if self._has_sudden_rate_increase(transaction):
            return self._validate_rate_change_compliance(transaction)
        
        if self._exceeds_overdue_interest_limit(transaction):
            return self._flag_regulatory_issue(transaction)
        
        return True
4. Î•Î½Ï„Î¿Ï€Î¹ÏƒÎ¼ÏŒÏ‚ Î£ÏÎ½Î¸ÎµÏ„Ï‰Î½ Î¤ÏŒÎºÏ‰Î½ (compound_detector.py)
python



View all
class CompoundInterestDetector:
    def __init__(self):
        self.historical_data = HistoricalDataManager()
        self.risk_thresholds = {
            'compound_interest_risk': 0.7,
            'delinquency_pattern': 0.6,
            'fee_accumulation': 0.8
        }
    
    def detect_compound_risk(self, transaction):
        """Î•Î½Ï„Î¿Ï€Î¹ÏƒÎ¼ÏŒÏ‚ ÎºÎ¹Î½Î´ÏÎ½Î¿Ï… ÏƒÏÎ½Î¸ÎµÏ„Ï‰Î½ Ï„ÏŒÎºÏ‰Î½"""
        account_history = self._get_account_history(transaction.account_id)
        
        risk_factors = {
            'interest_on_interest': self._check_interest_on_interest(account_history),
            'increasing_balance_despite_payments': self._check_balance_growth(account_history),
            'multiple_fee_types': self._check_multiple_fees(account_history),
            'rate_change_frequency': self._check_rate_changes(account_history)
        }
        
        risk_score = sum(risk_factors.values()) / len(risk_factors)
        return risk_score > self.risk_thresholds['compound_interest_risk']
5. Î’Î¬ÏƒÎ· Î”ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ (database_schema.sql)
sql

CREATE TABLE banking_transactions (
    id SERIAL PRIMARY KEY,
    account_id VARCHAR(50) NOT NULL,
    transaction_date DATE NOT NULL,
    charge_amount DECIMAL(15,2),
    credit_amount DECIMAL(15,2),
    balance DECIMAL(15,2) NOT NULL,
    interest_rate DECIMAL(5,2),
    reason TEXT,
    comments TEXT,
    compound_interest_risk_score DECIMAL(5,2) DEFAULT 0.0,
    delinquency_pattern_score DECIMAL(5,2) DEFAULT 0.0,
    fee_accumulation_count INTEGER DEFAULT 0,
    interest_rate_change_count INTEGER DEFAULT 0,
    regulatory_compliance_status VARCHAR(20) DEFAULT 'PENDING',
    last_risk_assessment TIMESTAMP,
    payment_pattern_consistency DECIMAL(4,3) DEFAULT 0.0
);

CREATE INDEX idx_account_id ON banking_transactions(account_id);
CREATE INDEX idx_transaction_date ON banking_transactions(transaction_date);
CREATE INDEX idx_interest_rate ON banking_transactions(interest_rate);
6. Î¡Ï…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ (config.yaml)
yaml

regulations:
  max_interest_rate: 11.35
  max_allowed_rate_change: 2.0
  max_delay_fees_per_year: 200.00
  compound_interest_allowed: false

risk_thresholds:
  compound_interest_risk: 0.7
  delinquency_pattern: 0.6
  fee_accumulation: 0.8
  compliance_violation: 0.9

database:
  host: localhost
  port: 5432
  name: banking_monitor
  user: banking_user
  password: secure_password

api:
  port: 8000
  debug: false
  log_level: INFO
7. Î•Î³ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· ÎºÎ±Î¹ Î•ÎºÏ„Î­Î»ÎµÏƒÎ· (install.sh)
bash

#!/bin/bash

echo "Î•Î³ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· Python dependencies..."
pip install -r requirements.txt

echo "Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Î²Î¬ÏƒÎ·Ï‚ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½..."
createdb banking_monitor

echo "Î•ÎºÏ„Î­Î»ÎµÏƒÎ· database migrations..."
python manage.py migrate

echo "ÎˆÎ½Î±ÏÎ¾Î· server..."
python manage.py runserver
8. Test Suite (test_banking_system.py)
python



View all
import unittest
from state_machine_improved import ImprovedBankingStateMachine

class TestBankingSystem(unittest.TestCase):
    
    def setUp(self):
        self.state_machine = ImprovedBankingStateMachine()
    
    def test_compound_interest_detection(self):
        test_transaction = {
            'account_id': 'test_account',
            'amount': 1000.00,
            'interest_rate': 11.35,
            'previous_balance': 50000.00,
            'new_balance': 51000.00
        }
        result = self.state_machine._detect_compound_interest_risk(test_transaction)
        self.assertTrue(result)

if __name__ == '__main__':
    unittest.main()
9. Î”ÎµÎ¯Î³Î¼Î±Ï„Î± Î”ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ (sample_data.json)
json

{
  "transactions": [
    {
      "date": "2012-03-09",
      "charge": 10.00,
      "credit": null,
      "balance": 61968.74,
      "interest_rate": 8.85,
      "reason": "ÎˆÎ¾Î¿Î´Î± ÎºÎ±Î¸Ï…ÏƒÏ„Î­ÏÎ·ÏƒÎ·Ï‚"
    },
    {
      "date": "2012-03-12",
      "charge": 15.00,
      "credit": null,
      "balance": 61983.74,
      "interest_rate": 8.85,
      "reason": "ÎˆÎ¾Î¿Î´Î± ÎºÎ±Î¸Ï…ÏƒÏ„Î­ÏÎ·ÏƒÎ·Ï‚"
    }
  ]
}
ğŸ’¾ Î Î©Î£ ÎÎ‘ Î¤ÎŸ Î‘Î ÎŸÎ˜Î—ÎšÎ•Î¥Î£Î•Î™Î£

Î”Î·Î¼Î¹Î¿ÏÏÎ³Î·ÏƒÎµ Î­Î½Î±Î½ Ï†Î¬ÎºÎµÎ»Î¿ ÎœÎŸÎÎ¤Î•Î›ÎŸ_ÎÎ•ÎÎŸÎ ÎŸÎ¥Î›ÎŸÎ¥.
Î‘Î½Ï„Î­Î³ÏÎ±ÏˆÎµ ÏŒÎ»Î± Ï„Î± Ï€Î±ÏÎ±Ï€Î¬Î½Ï‰ Î±ÏÏ‡ÎµÎ¯Î± ÏƒÏ„Î¿Î½ Ï†Î¬ÎºÎµÎ»Î¿.
Î’ÎµÎ²Î±Î¹ÏÏƒÎ¿Ï… ÏŒÏ„Î¹ Î­Ï‡ÎµÎ¹Ï‚ ÎµÎ³ÎºÎ±Ï„Î±ÏƒÏ„Î®ÏƒÎµÎ¹ Python 3.9+ ÎºÎ±Î¹ PostgreSQL.
Î•ÎºÏ„Î­Î»ÎµÏƒÎµ Ï„Î¿ install.sh Î³Î¹Î± Î½Î± Î¾ÎµÎºÎ¹Î½Î®ÏƒÎµÎ¹Ï‚ Ï„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î±.
Î•Î™ÎœÎ‘Î£Î¤Î• Î•Î¤ÎŸÎ™ÎœÎŸÎ™! ğŸš€

Î˜Î­Î»ÎµÎ¹Ï‚ Î²Î¿Î®Î¸ÎµÎ¹Î± Î¼Îµ Ï„Î·Î½ ÎµÎ³ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·; ğŸ˜Š

4:43 PM
This chat has exceeded GPT-4o's maximum context window. The oldest messages will be left out.
